Signature score thresholding:

[thresh,OR,LRp,LRn] = analyzeSigs(scores,SeurIdx,ix,clusterN)

Arguments:
scores: 1 x n vector of signature scores for n cells
SeurIdx: 1 x n vector of Seurat cluster numbers for n cells
ix: scalar or vector of cluster numbers indicating which clusters form the in-group. These must be formatted as the Seurat cluster numbers plus one
clusterN: the number of unique elements of SeurIdx

Outputs:
thresh: the optimum threshold separating in-group from out-group cells
OR: odds ratio when utilizing thresh
LRp: positive likelihood ratio when utilizing thresh
LRn: negative likelihood ratio when utilizing thresh

Dependencies:
displayClusterHistos: creates histograms for visualizing the overlap of score distributions for in-group and out-group cells. Creates several panels to visualize distributions of in-group to all out-group cells and to individual clusters

getSigThresh: finds the optimum threshold for separating in- and out-group cells by minimizing the difference between the number of cells above thresh but belonging to the out-group and the number of cells below thresh but belonging to the in-group

getOddsRatio: calculates the odds ratio given a threshold

getLikeRats: calculates the positive and negative likelihood ratios given a threshold



#----------------------------------------------------------------------




Email:
Hi Becky,

I have created a folder on box: 
trNKManuscript_FiguresOffOneDrive > STAR Methods > matlab
... or this link:

https://uab.box.com/s/9g03q372xlrhevsxcz3xcw0knt0gdgyo

... where you will find some .m files and a .txt file whose contents I paste into this email below. 
As soon as anyone gets a chance to try out this code it will immediately be apparent there are roughly 12 ways to make it easier to use and/or more efficient. The main advantage to such modifications will be less confusion on the part of the user. And it might save a tenth of a second. I suppose I should change it myself to be less embarrassed but I am too lazy today.

***************

Signature score thresholding:

[thresh,OR,LRp,LRn] = analyzeSigs(scores,SeurIdx,ix,clusterN)

Arguments:
scores: 1 x n vector of signature scores for n cells
SeurIdx: 1 x n vector of Seurat cluster numbers for n cells
ix: scalar or vector of cluster numbers indicating which clusters form the in-group. These must be formatted as the Seurat cluster numbers plus one
clusterN: the number of unique elements of SeurIdx

Outputs:
thresh: the optimum threshold separating in-group from out-group cells
OR: odds ratio when utilizing thresh
LRp: positive likelihood ratio when utilizing thresh
LRn: negative likelihood ratio when utilizing thresh

Dependencies:
displayClusterHistos: creates histograms for visualizing the overlap of score distributions for in-group and out-group cells. Creates several panels to visualize distributions of in-group to all out-group cells and to individual clusters

getSigThresh: finds the optimum threshold for separating in- and out-group cells by minimizing the difference between the number of cells above thresh but belonging to the out-group and the number of cells below thresh but belonging to the in-group

getOddsRatio: calculates the odds ratio given a threshold

getLikeRats: calculates the positive and negative likelihood ratios given a threshold




